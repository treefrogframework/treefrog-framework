
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><link rel="canonical" href="http://mongoc.org/libbson/current/mongoc_collection_count.html"/>
    <title>mongoc_collection_count() &#8212; libmongoc 1.21.2</title>
    <link rel="stylesheet" href="_static/readable.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/readable.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mongoc_collection_count_with_opts()" href="mongoc_collection_count_with_opts.html" />
    <link rel="prev" title="mongoc_collection_estimated_document_count()" href="mongoc_collection_estimated_document_count.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="mongoc_collection_count_with_opts.html" title="mongoc_collection_count_with_opts()"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="mongoc_collection_estimated_document_count.html" title="mongoc_collection_estimated_document_count()"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">libmongoc 1.21.2</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="api.html" >API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="mongoc_collection_t.html" accesskey="U">mongoc_collection_t</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mongoc-collection-count">
<h1>mongoc_collection_count()<a class="headerlink" href="#mongoc-collection-count" title="Permalink to this headline">¶</a></h1>
<div class="section" id="deprecated">
<h2>Deprecated<a class="headerlink" href="#deprecated" title="Permalink to this headline">¶</a></h2>
<p>This function is deprecated and should not be used in new code.
Use <a class="symbol reference internal" href="mongoc_collection_count_documents.html"><span class="doc">mongoc_collection_count_documents()</span></a> or <a class="symbol reference internal" href="mongoc_collection_estimated_document_count.html"><span class="doc">mongoc_collection_estimated_document_count()</span></a> instead.</p>
<p><a class="symbol reference internal" href="mongoc_collection_count_documents.html"><span class="doc">mongoc_collection_count_documents()</span></a> has similar performance to calling <a class="symbol reference internal" href="#"><span class="doc">mongoc_collection_count()</span></a> with a non-NULL <code class="docutils literal notranslate"><span class="pre">query</span></code>, and is guaranteed to retrieve an accurate collection count. See <a class="reference internal" href="mongoc_collection_count_documents.html#migrating-from-deprecated-count"><span class="std std-ref">migrating from deprecated count functions</span></a> for details.</p>
<p><a class="symbol reference internal" href="mongoc_collection_estimated_document_count.html"><span class="doc">mongoc_collection_estimated_document_count()</span></a> has the same performance as calling <a class="symbol reference internal" href="#"><span class="doc">mongoc_collection_count()</span></a> with a NULL <code class="docutils literal notranslate"><span class="pre">query</span></code>, but is not guaranteed to retrieve an accurate collection count.</p>
<p>This function is considered a retryable read operation.
Upon a transient error (a network error, errors due to replica set failover, etc.) the operation is safely retried once.
If <code class="docutils literal notranslate"><span class="pre">retryreads</span></code> is false in the URI (see <a class="symbol reference internal" href="mongoc_uri_t.html"><span class="doc">mongoc_uri_t</span></a>) the retry behavior does not apply.</p>
</div>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int64_t</span>
<span class="nf">mongoc_collection_count</span> <span class="p">(</span><span class="n">mongoc_collection_t</span> <span class="o">*</span><span class="n">collection</span><span class="p">,</span>
                         <span class="n">mongoc_query_flags_t</span> <span class="n">flags</span><span class="p">,</span>
                         <span class="k">const</span> <span class="n">bson_t</span> <span class="o">*</span><span class="n">query</span><span class="p">,</span>
                         <span class="kt">int64_t</span> <span class="n">skip</span><span class="p">,</span>
                         <span class="kt">int64_t</span> <span class="n">limit</span><span class="p">,</span>
                         <span class="k">const</span> <span class="n">mongoc_read_prefs_t</span> <span class="o">*</span><span class="n">read_prefs</span><span class="p">,</span>
                         <span class="n">bson_error_t</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span>
 <span class="n">BSON_GNUC_DEPRECATED_FOR</span> <span class="p">(</span><span class="n">mongoc_collection_count_documents</span> <span class="n">or</span>
                           <span class="n">mongoc_collection_estimated_document_count</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">collection</span></code>: A <a class="symbol reference internal" href="mongoc_collection_t.html"><span class="doc">mongoc_collection_t</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flags</span></code>: A <a class="symbol reference internal" href="mongoc_query_flags_t.html"><span class="doc">mongoc_query_flags_t</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">query</span></code>: A <a class="symbol reference external" href="http://mongoc.org/libbson/current/bson_t.html" title="(in libbson v1.21.2)"><code class="xref symbol docutils literal notranslate"><span class="pre">bson_t</span></code></a> containing the query.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skip</span></code>: A int64_t, zero to ignore.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">limit</span></code>: A int64_t, zero to ignore.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_prefs</span></code>: A <a class="symbol reference internal" href="mongoc_read_prefs_t.html"><span class="doc">mongoc_read_prefs_t</span></a> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error</span></code>: An optional location for a <a class="symbol reference internal" href="errors.html"><span class="doc">bson_error_t</span></a> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></li>
</ul>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This function shall execute a count query on the underlying ‘collection’. The bson ‘query’ is not validated, simply passed along as appropriate to the server.  As such, compatibility and errors should be validated in the appropriate server documentation.</p>
<p>For more information, see the <a class="reference external" href="https://docs.mongodb.org/manual/reference/operator/query/">query reference</a> at the MongoDB website.</p>
<p>The <a class="symbol reference internal" href="mongoc_read_concern_t.html"><span class="doc">mongoc_read_concern_t</span></a> specified on the <a class="symbol reference internal" href="mongoc_collection_t.html"><span class="doc">mongoc_collection_t</span></a> will be used, if any. If <code class="docutils literal notranslate"><span class="pre">read_prefs</span></code> is NULL, the collection’s read preferences are used.</p>
</div>
<div class="section" id="errors">
<h2>Errors<a class="headerlink" href="#errors" title="Permalink to this headline">¶</a></h2>
<p>Errors are propagated via the <code class="docutils literal notranslate"><span class="pre">error</span></code> parameter.</p>
</div>
<div class="section" id="returns">
<h2>Returns<a class="headerlink" href="#returns" title="Permalink to this headline">¶</a></h2>
<p>-1 on failure, otherwise the number of documents counted.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;bson/bson.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;mongoc/mongoc.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="k">static</span> <span class="kt">void</span>
<span class="nf">print_query_count</span> <span class="p">(</span><span class="n">mongoc_collection_t</span> <span class="o">*</span><span class="n">collection</span><span class="p">,</span> <span class="n">bson_t</span> <span class="o">*</span><span class="n">query</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">bson_error_t</span> <span class="n">error</span><span class="p">;</span>
   <span class="kt">int64_t</span> <span class="n">count</span><span class="p">;</span>

   <span class="n">count</span> <span class="o">=</span> <span class="n">mongoc_collection_count</span> <span class="p">(</span>
      <span class="n">collection</span><span class="p">,</span> <span class="n">MONGOC_QUERY_NONE</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Count failed: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">);</span>
   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span> <span class="p">(</span><span class="s">&quot;%&quot;</span> <span class="n">PRId64</span> <span class="s">&quot; documents counted.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">count</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installing the MongoDB C Driver (libmongoc) and BSON library (libbson)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic-troubleshooting.html">Basic Troubleshooting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="guides.html">Guides</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="init-cleanup.html">Initialization and cleanup</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="errors.html">Error Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifecycle.html">Object Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="gridfs.html">GridFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_auto_encryption_opts_t.html">mongoc_auto_encryption_opts_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_bulk_operation_t.html">mongoc_bulk_operation_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_change_stream_t.html">mongoc_change_stream_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_encryption_t.html">mongoc_client_encryption_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_encryption_datakey_opts_t.html">mongoc_client_encryption_datakey_opts_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_encryption_encrypt_opts_t.html">mongoc_client_encryption_encrypt_opts_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_encryption_opts_t.html">mongoc_client_encryption_opts_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_pool_t.html">mongoc_client_pool_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_session_t.html">mongoc_client_session_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_session_with_transaction_cb_t.html">mongoc_client_session_with_transaction_cb_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_client_t.html">mongoc_client_t</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="mongoc_collection_t.html">mongoc_collection_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_cursor_t.html">mongoc_cursor_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_database_t.html">mongoc_database_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_delete_flags_t.html">mongoc_delete_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_find_and_modify_opts_t.html">mongoc_find_and_modify_opts_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_gridfs_file_list_t.html">mongoc_gridfs_file_list_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_gridfs_file_opt_t.html">mongoc_gridfs_file_opt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_gridfs_file_t.html">mongoc_gridfs_file_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_gridfs_bucket_t.html">mongoc_gridfs_bucket_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_gridfs_t.html">mongoc_gridfs_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_host_list_t.html">mongoc_host_list_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_index_opt_geo_t.html">mongoc_index_opt_geo_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_index_opt_t.html">mongoc_index_opt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_index_opt_wt_t.html">mongoc_index_opt_wt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_insert_flags_t.html">mongoc_insert_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_iovec_t.html">mongoc_iovec_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_matcher_t.html">mongoc_matcher_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_optional_t.html">mongoc_optional_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_query_flags_t.html">mongoc_query_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_rand.html">mongoc_rand</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_read_concern_t.html">mongoc_read_concern_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_read_mode_t.html">mongoc_read_mode_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_read_prefs_t.html">mongoc_read_prefs_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_remove_flags_t.html">mongoc_remove_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_reply_flags_t.html">mongoc_reply_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_server_api_t.html">mongoc_server_api_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_server_api_version_t.html">mongoc_server_api_version_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_server_description_t.html">mongoc_server_description_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_session_opt_t.html">mongoc_session_opt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_socket_t.html">mongoc_socket_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_ssl_opt_t.html">mongoc_ssl_opt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_stream_buffered_t.html">mongoc_stream_buffered_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_stream_file_t.html">mongoc_stream_file_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_stream_socket_t.html">mongoc_stream_socket_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_stream_t.html">mongoc_stream_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_stream_tls_t.html">mongoc_stream_tls_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_topology_description_t.html">mongoc_topology_description_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_transaction_opt_t.html">mongoc_transaction_opt_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_transaction_state_t.html">mongoc_transaction_state_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_update_flags_t.html">mongoc_update_flags_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_uri_t.html">mongoc_uri_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_version.html">Version Checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoc_write_concern_t.html">mongoc_write_concern_t</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="application-performance-monitoring.html">Application Performance Monitoring (APM)</a></li>
</ul>
<!-- Because full_index.rst includes everything that index.rst includes, we have to exclude index.rst from the table-of-contents. This page is simply a link forced into the sidebar (in conf.py) to avoid including full_index.rst in the ToC. -->
<ul><li class='toctree-l1'><a href="full_index.html">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2017-present, MongoDB, Inc.
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.1.2.
  </div>
  
  </body>
</html>